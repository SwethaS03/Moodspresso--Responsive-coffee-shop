<!DOCTYPE HTML>
<html lang="en" >
<html>
<head>
  <title>Login</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta charset="utf-8">
  <link rel="stylesheet" type="text/css" href="login_style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link href='https://fonts.googleapis.com/css?family=Titillium+Web:400,300,600' rel='stylesheet' type='text/css'>  
  <link href='https://fonts.googleapis.com/css?family=Titillium+Web:400,300,600' rel='stylesheet' type='text/css'> 
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" integrity="sha384-vp86vTRFVJgpjF9jiIGPEEqYqlDwgyBgEF109VFjmqGmIY/Y4HV4d3Gp2irVfcrp" crossorigin="anonymous">
</head>

<body class="body">
<div class="login-page container">
  <div class="form">

    <form>
        <lottie-player src="https://assets5.lottiefiles.com/private_files/lf30_fpdvsz3i.json"  background="transparent"  speed="1"  style="width: 300px; height: 300px;"  loop  autoplay></lottie-player>
      <input type="text" id="email" placeholder="&#xf007;  email"/>
      <input type="password" id="password" placeholder="&#xf023;  password"/>
      <br>
      <br>
      <p class="message"></p>
    </form>
    <button id="login">LOGIN</button>
    <form class="login-form">
      <button type="button" onclick="window.location.href='signup.html'">SIGN UP</button>
    </form>
  </div>
</div>


  </script>
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.4.0/firebase-app.js";
    import { getDatabase, set, ref, update } from "https://www.gstatic.com/firebasejs/9.4.0/firebase-database.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/9.4.0/firebase-auth.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
       
    const firebaseConfig = {
        apiKey: "AIzaSyBPxlIPSt3hauAtZl99jhg140tQjdEETeY",
        authDomain: "moodspresso-79e57.firebaseapp.com",
        databaseURL: "https://moodspresso-79e57-default-rtdb.firebaseio.com",
        projectId: "moodspresso-79e57",
        storageBucket: "moodspresso-79e57.appspot.com",
        messagingSenderId: "194723202420",
        appId: "1:194723202420:web:96715fc092392fe3a15821",
        measurementId: "G-769Q3BRRKL"
    };
    
      const app = initializeApp(firebaseConfig);
      const database = getDatabase(app);
      const auth = getAuth();

      login.addEventListener('click',(e)=>{
          var email = document.getElementById('email').value;
          var password = document.getElementById('password').value;

              signInWithEmailAndPassword(auth, email, password)
              .then((userCredential) => {
                // Signed in 
                const user = userCredential.user;

                const dt = new Date();
                update(ref(database, 'users/' + user.uid),{
                  last_login: dt,
                })

                window.location="Moodspresso.html";
                // ...
              })
              .catch((error) => {
                const errorCode = error.code;
                const errorMessage = error.message;

                alert(errorMessage);
  });

 });
</script>
</body>
</html>

